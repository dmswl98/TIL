# π”ƒ λ‚™κ΄€μ  μ—…λ°μ΄νΈ

## λ‚™κ΄€μ  vs λΉ„κ΄€μ  μ—…λ°μ΄νΈ

- λ‚™κ΄€μ  μ—…λ°μ΄νΈ : μ‚¬μ©μμ μ…λ ¥μ— λ”°λΌ μ¦‰κ°μ μΌλ΅ ν™”λ©΄μ„ κ°±μ‹ ν• ν›„μ— μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚΄λ” λ°©λ²•μ΄λ©° μ΄ν›„ μ„λ²„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ™€
- λΉ„κ΄€μ  μ—…λ°μ΄νΈ : μ‚¬μ©μμ— μ…λ ¥μ— λ”°λΌ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚Έ ν›„ μ„λ²„μ— λ°μλ λ°μ΄ν„°λ¥Ό ν† λ€λ΅ ν™”λ©΄ λλ”λ§ν•λ” λ°©λ²•

## λ‚™κ΄€μ  μ—…λ°μ΄νΈμ μ‚¬μ© λ©μ 

λ‚™κ΄€μ  μ—…λ°μ΄νΈλ” λ¨Όμ € μƒνƒκ°’μ„ λ³€κ²½ν•κ³  μ΄ν›„μ— μ„λ²„μ— λ°μ΄ν„°λ¥Ό λ°μν•λ” λ°©μ‹μ„ λ§ν•λ‹¤. μ£Όλ΅ μ„λ²„μ— μμ • μ”μ²­ν• ν›„ λ°μλ λ°μ΄ν„°λ¥Ό λ°›μ•„μ¤κΈ°κΉμ§€μ μ‹κ°„ μ°¨λ¥Ό μ¤„μ΄κ³ μ μ‚¬μ©ν•λ‹¤. μ¤‘μ”ν• κΈ°λ¥μ κ²½μ° λΉ„κ΄€μ  μ—…λ°μ΄νΈλ΅ κµ¬ν„ν•λ μ‹¤μ‹κ°„ μ—…λ°μ΄νΈλ‚ μ„ν—λ„κ°€ λ‚®μ€ κΈ°λ¥μ€ λ‚™κ΄€μ  μ—…λ°μ΄νΈλ¥Ό μ΄μ©ν•΄ κµ¬ν„ν•μ—¬ μ‚¬μ©μμ μ›Ή κ²½ν—μ„ λ†’μΌ μ μλ‹¤. λ‹¤λ§ μ„λ²„μ— λ°μ΄ν„°κ°€ μ λ€λ΅ λ°μλμ§€ μ•μ€ κ²½μ° μ‚¬μ©μκ°€ μ΄λ¥Ό ν™•μΈν•  μ μ—†λ‹¤λ” λ‹¨μ μ΄ μ΅΄μ¬ν•λ‹¤.

## λ‚™κ΄€μ  μ—…λ°μ΄νΈ κµ¬ν„ μ½”λ“

```javascript
const productList = new productList({
  $target,
  initialState,
  onAddToCart: async (id) => {
    // μƒνƒ λ³€κ²½
    const productIndex = this.state.products.findIndex(
      (product) => product.id === id
    );
    const nextProducts = [...this.state.products];
    nextProducts[productIndex].count += 1;

    // μ—…λ°μ΄νΈλ μƒνƒκ°’μ„ ν† λ€λ΅ λλ”λ§
    this.setState({
      ...this.state,
      products: nextProducts,
    });

    // μ„λ²„μ— λ°μ΄ν„° λ³€κ²½
    await fetch(`/${this.state.selectedItem}/${id}`, {
      method: "PUT",
    });

    // μ„λ²„μ λ°μ΄ν„°λ¥Ό λ°μν•΄ ν™”λ©΄ λλ”λ§
    await fetchProducts();
  },
});

const fetchProducts = async () => {
  const { selectedItem } = this.state;

  if (selectedItem) {
    this.setState({
      ...this.state,
      isLoading: true,
    });

    const products = await fetch(`/${selectedItem}`);

    this.setState({
      ...this.state,
      products,
      isLoading: false,
    });
  }
};
```

μ•„λμ™€ κ°™μ΄ onAddToCart λ‚΄λ¶€μ—μ„ μ„λ²„λ΅ μ”μ²­μ„ λ³΄λ‚΄ μ„λ²„μ— μ €μ¥λ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤κΈ°μ™€ ν™”λ©΄μ— λ°μν•κΈ°κΉμ§€ μ‹κ°„μ΄ λ‹¤μ† κ±Έλ¦΄ μ μλ‹¤. ν™”λ©΄μ— μ μ©λλ” λ°μ΄ν„°κ°€ μ„λ²„μ— μμ΅΄ν•κΈ° λ•λ¬Έμ— ν΄λΌμ΄μ–ΈνΈλ” λ³€κ²½μ΄ λ°μλ λ°μ΄ν„°λ¥Ό λΉ λ¥΄κ² ν™•μΈν•  μ μ—†λ‹¤.

```javascript
onAddToCart: async (id) => {
  await fetch(`/${this.state.selectedItem}/${id}`, {
    method: "PUT",
  });

  await fetchProducts();
},
```

β€λ‚™κ΄€μ  μ—…λ°μ΄νΈβ€™λ΅ μ΄λ¥Ό ν•΄κ²°ν•  μ μλ‹¤.

1. λ¨Όμ € μ‚¬μ©μμ μ…λ ¥κ°’μ„ μ €μ¥ν•  μƒνƒλ¥Ό λ‘κ³  μ΄ μƒνƒκ°’μ„ λ³€κ²½ν•λ‹¤.
2. λ³€κ²½λ μƒνƒκ°’μ„ ν† λ€λ΅ λλ”λ§ν• ν›„μ— μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚΄ μ‚¬μ©μμ μ…λ ¥κ°’μ„ λ°μν•λ‹¤.
3. μ”μ²­μ„ λ³΄λ‚΄λ” ν•¨μ(fetchproducts) λ‚΄λ¶€μ— μ„λ²„λ΅λ¶€ν„° λ°›μ•„μ¨ λ°μ΄ν„°λ΅ μƒνƒλ¥Ό μ—…λ°μ΄νΈν•λ” λ΅μ§μ„ μ¶”κ°€ν•΄ λ‹¤μ‹ ν• λ² λλ”λ§ν•λ‹¤.
